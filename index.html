<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solfeggio Mixer | Professional Grade</title>
    <style>
        :root {
            --p-bg: #000; --c-bg: #0d0d0d; --start-y: #ffd60a; --save-g: #20c997; 
            --txt: #fff; --dim: #555; --m-red: #d90429; --s-blue: #00b4d8;
        }
        body { background: var(--p-bg); color: var(--txt); font-family: 'Inter', sans-serif; margin: 0; overflow-x: hidden; }
        
        /* Layout & Ads */
        .master-wrapper { display: flex; justify-content: center; align-items: flex-start; width: 100%; min-width: 1450px; padding-top: 40px; }
        .ad-zone { width: 160px; height: 600px; background: #0a0a0a; border: 1px solid #1a1a1a; display: flex; align-items: center; justify-content: center; position: sticky; top: 40px; }
        .ad-txt { color: #222; font-size: 10px; transform: rotate(-90deg); letter-spacing: 4px; font-weight: 900; }

        /* Mixer UI */
        .main-stage { display: flex; flex-direction: column; align-items: center; padding: 0 40px; }
        h1 { font-weight: 200; letter-spacing: 12px; font-size: 2.5rem; margin-bottom: 30px; }
        .info-btn { display: inline-block; border: 1px solid #444; border-radius: 50%; width: 22px; height: 22px; line-height: 22px; cursor: pointer; font-size: 0.7rem; color: #777; margin-left: 10px; vertical-align: middle; }

        .mixer-box { background: #080808; padding: 40px; border-radius: 40px; border: 1px solid #111; display: flex; gap: 12px; }
        .strip { width: 100px; background: #111; padding: 25px 0; border-radius: 20px; display: flex; flex-direction: column; align-items: center; border: 1px solid #222; }
        
        /* THE SPECIFIC BORDER GLOW */
        .fader-slot { 
            width: 12px; height: 240px; background: #000; border-radius: 10px; position: relative; 
            margin: 20px 0; border: 1px solid transparent; transition: 0.3s;
        }
        
        input[type=range][orient=vertical] { appearance: slider-vertical; width: 12px; height: 240px; background: transparent; cursor: pointer; }

        /* Control Bar */
        .controls { margin-top: 40px; display: flex; align-items: center; gap: 15px; }
        .timer-ctrl { background: #111; border: 1px solid #222; padding: 10px; border-radius: 10px; display: flex; align-items: center; gap: 10px; }
        select { background: transparent; color: #ffd60a; border: none; font-weight: bold; cursor: pointer; }

        #startBtn { background: var(--start-y); color: #000; padding: 18px 50px; border-radius: 50px; font-weight: 900; border: none; cursor: pointer; }
        .util-btn { background: #151515; color: #888; border: 1px solid #222; padding: 14px 25px; border-radius: 50px; font-size: 0.7rem; font-weight: 800; cursor: pointer; }
        .save-btn { background: var(--save-g); color: #000; font-weight: 900; border: none; padding: 14px 40px; border-radius: 50px; cursor: pointer; }

        /* Modals */
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.97); z-index:9999; align-items:center; justify-content:center; }
        .card { background:#0a0a0a; padding:50px; border-radius:30px; border:1px solid #222; width:500px; text-align:center; }
        .card h2 { color: var(--start-y); letter-spacing: 4px; margin-bottom: 30px; } /* YELLOW USER GUIDE */
    </style>
</head>
<body>

<div class="master-wrapper">
    <div class="ad-zone"><span class="ad-txt">ADVERTISEMENT</span></div>

    <div class="main-stage">
        <h1>SOLFEGGIO PLAYER <div class="info-btn" onclick="openInfo()">i</div></h1>

        <div class="mixer-box" id="board">
            </div>

        <div class="controls">
            <div class="timer-ctrl">
                <span style="font-size: 0.7rem; color: #444;">TIMER</span>
                <select id="timerSet">
                    <option value="1">1 MIN</option>
                    <option value="15">15 MIN</option>
                    <option value="30" selected>30 MIN</option>
                    <option value="60">1 HOUR</option>
                    <option value="120">2 HOURS</option>
                    <option value="240">4 HOURS</option>
                    <option value="480">8 HOURS</option>
                </select>
                <div id="countdown" style="font-family: monospace; color: #4caf50; min-width: 50px;">--:--</div>
            </div>
            
            <button id="startBtn" onclick="begin()">START SESSION</button>
            <button id="pauseBtn" style="display:none; background:#4caf50; color:#fff; padding:18px 50px; border-radius:50px; font-weight:900; border:none;" onclick="toggleP()">PAUSE ALL</button>
            <button class="util-btn" onclick="randomize()">RANDOM</button>
            <button class="util-btn" onclick="reset()">RESET</button>
            <button class="save-btn" onclick="openSave()">SAVE</button>
            <button class="util-btn" onclick="generateShare()">SHARE</button>
        </div>
    </div>

    <div class="ad-zone"><span class="ad-txt">ADVERTISEMENT</span></div>
</div>

<div id="iMod" class="overlay"><div class="card">
    <h2>USER GUIDE</h2>
    <div style="text-align:left; color:#888; font-size:0.9rem; line-height:1.8;">
        <p><strong>HEADPHONES:</strong> Required for stereo brain stimulation.</p>
        <p><strong>VOLUME:</strong> Moderate levels. Healing is not about loudness.</p>
        <p><strong>SAVE:</strong> Sync your custom mixes to your library.</p>
        <p><strong>SHARE:</strong> Creates a link with your exact fader positions.</p>
    </div>
    <button class="util-btn" style="width:100%; margin-top:20px;" onclick="closeInfo()">BACK TO MIXER</button>
</div></div>

<script>
    const data = [
        {h:"69.3Hz", d:"Resonance", c:"#4a00e0"}, {h:"174Hz", d:"Relieve Pain", c:"#ffffff"},
        {h:"285Hz", d:"Body Recovery", c:"#9b2226"}, {h:"396Hz", d:"Release Fear", c:"#ae2012"},
        {h:"417Hz", d:"Change Cycles", c:"#ca6702"}, {h:"432Hz", d:"Relaxation", c:"#ee9b00"},
        {h:"528Hz", d:"DNA Repair", c:"#0a9396"}, {h:"639Hz", d:"Relationships", c:"#005f73"},
        {h:"741Hz", d:"Detox Mind", c:"#3e5c76"}, {h:"852Hz", d:"Intuition", c:"#5e548e"},
        {h:"963Hz", d:"Consciousness", c:"#9d4edd"}
    ];

    let tracks = [], ctx, master, isP = false, time = 0, timerActive = false;

    // BUILD MIXER
    const board = document.getElementById('board');
    data.forEach((ch, i) => {
        board.innerHTML += `
            <div class="strip">
                <div style="color:${ch.c}; font-weight:900; font-size:0.9rem;">${ch.h}</div>
                <div style="font-size:0.5rem; color:#444; margin-top:4px;">${ch.d.toUpperCase()}</div>
                <div class="fader-slot" id="slot-${i}">
                    <input type="range" orient="vertical" id="v-${i}" min="0" max="1" step="0.01" value="0.30" oninput="slide(${i},this.value)">
                </div>
                <div id="p-${i}" style="font-size:0.7rem; color:#333;">30%</div>
            </div>
        `;
    });

    function slide(i, v) {
        if(tracks[i]) tracks[i].g.gain.setTargetAtTime(isP ? 0 : v, ctx.currentTime, 0.1);
        document.getElementById(`p-${i}`).innerText = Math.round(v*100) + "%";
        // TARGETED BORDER GLOW ONLY
        document.getElementById(`slot-${i}`).style.borderColor = v > 0 ? data[i].c : 'transparent';
        document.getElementById(`slot-${i}`).style.boxShadow = `0 0 ${v * 20}px ${data[i].c}`;
    }

    async function begin() {
        ctx = new AudioContext();
        master = ctx.createGain(); master.connect(ctx.destination);
        for(let i=0; i<data.length; i++) {
            const osc = ctx.createOscillator();
            const g = ctx.createGain();
            osc.frequency.value = parseFloat(data[i].h);
            osc.connect(g); g.connect(master); osc.start();
            tracks[i] = {o:osc, g:g, v:0.3};
            slide(i, 0.3);
        }
        document.getElementById('startBtn').style.display='none';
        document.getElementById('pauseBtn').style.display='block';
        startTimer();
    }

    function startTimer() {
        time = document.getElementById('timerSet').value * 60;
        timerActive = true;
        setInterval(() => {
            if(timerActive && !isP && time > 0) {
                time--;
                let m = Math.floor(time/60), s = time%60;
                document.getElementById('countdown').innerText = `${m}:${s<10?'0'+s:s}`;
            }
        }, 1000);
    }

    function generateShare() {
        let params = tracks.map((t, i) => `v${i}=${document.getElementById(`v-${i}`).value}`).join('&');
        let url = window.location.origin + window.location.pathname + '?' + params;
        navigator.clipboard.writeText(url);
        alert("Settings copied to link!");
    }

    function openInfo() { document.getElementById('iMod').style.display='flex'; }
    function closeInfo() { document.getElementById('iMod').style.display='none'; }
    function toggleP() { isP = !isP; tracks.forEach((t, i) => slide(i, isP ? 0 : document.getElementById(`v-${i}`).value)); }
</script>
</body>
</html>
